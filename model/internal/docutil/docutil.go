//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package docutil ;import (_a "errors";_ac "fmt";_eg "github.com/unidoc/unipdf/v3/common";_b "github.com/unidoc/unipdf/v3/core";_d "github.com/unidoc/unipdf/v3/internal/xmp";);func (_gd *Document )AddStream (stream *_b .PdfObjectStream ){for _ ,_aac :=range _gd .Objects {if _aac ==stream {return ;
};};_gd .Objects =append (_gd .Objects ,stream );};func (_gfc *OutputIntents )Len ()int {return _gfc ._cg .Len ()};func (_fc *Document )GetPages ()([]Page ,bool ){_eab ,_bd :=_fc .FindCatalog ();if !_bd {return nil ,false ;};return _eab .GetPages ();};
func (_ega Page )GetResourcesXObject ()(*_b .PdfObjectDictionary ,bool ){_cef ,_bac :=_ega .GetResources ();if !_bac {return nil ,false ;};return _b .GetDict (_cef .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));};func (_gg *Catalog )SetOutputIntents (outputIntents *OutputIntents ){if _ed :=_gg .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");
_ed !=nil {for _edf ,_ce :=range _gg ._c .Objects {if _ce ==_ed {if outputIntents ._abf ==_ed {return ;};_gg ._c .Objects =append (_gg ._c .Objects [:_edf ],_gg ._c .Objects [_edf +1:]...);break ;};};};_ge :=outputIntents ._abf ;if _ge ==nil {_ge =_b .MakeIndirectObject (outputIntents ._cg );
};_gg .Object .Set ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073",_ge );_gg ._c .Objects =append (_gg ._c .Objects ,_ge );};func (_bb Page )GetContents ()([]Content ,bool ){_gbg ,_ecf :=_b .GetArray (_bb .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));
if !_ecf {return nil ,false ;};_dadg :=make ([]Content ,_gbg .Len ());for _fcd ,_bae :=range _gbg .Elements (){_dadg [_fcd ]=Content {Object :_bae };};return _dadg ,true ;};func (_eec *Document )FindCatalog ()(*Catalog ,bool ){var _acd *_b .PdfObjectDictionary ;
for _ ,_aab :=range _eec .Objects {_da ,_aba :=_b .GetDict (_aab );if !_aba {continue ;};if _ecc ,_fb :=_b .GetName (_da .Get ("\u0054\u0079\u0070\u0065"));_fb &&*_ecc =="\u0043a\u0074\u0061\u006c\u006f\u0067"{_acd =_da ;break ;};};if _acd ==nil {return nil ,false ;
};return &Catalog {Object :_acd ,_c :_eec },true ;};type Catalog struct{Object *_b .PdfObjectDictionary ;_c *Document ;};type Document struct{ID [2]string ;Version _b .Version ;Objects []_b .PdfObject ;Info _b .PdfObject ;Crypt *_b .PdfCrypt ;UseHashBasedID bool ;
};func (_ccea Page )FindXObjectImages ()([]*Image ,error ){_bc ,_cfe :=_ccea .GetResourcesXObject ();if !_cfe {return nil ,nil ;};var _ca []*Image ;var _eccf error ;_gfca :=map[*_b .PdfObjectStream ]int {};_cda :=map[*_b .PdfObjectStream ]struct{}{};var _be int ;
for _ ,_dcg :=range _bc .Keys (){_bef ,_fge :=_b .GetStream (_bc .Get (_dcg ));if !_fge {continue ;};if _ ,_eda :=_gfca [_bef ];_eda {continue ;};_ggc ,_ece :=_b .GetName (_bef .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));if !_ece ||_ggc .String ()!="\u0049\u006d\u0061g\u0065"{continue ;
};_eea :=Image {BitsPerComponent :8,Stream :_bef ,Name :string (_dcg )};if _eea .Colorspace ,_eccf =_gde (_bef .PdfObjectDictionary .Get ("\u0043\u006f\u006c\u006f\u0072\u0053\u0070\u0061\u0063\u0065"));_eccf !=nil {_eg .Log .Error ("\u0045\u0072\u0072\u006f\u0072\u0020\u0064\u0065\u0074\u0065r\u006d\u0069\u006e\u0065\u0020\u0063\u006fl\u006f\u0072\u0020\u0073\u0070\u0061\u0063\u0065\u0020\u0025\u0073",_eccf );
continue ;};if _gga ,_fbg :=_b .GetIntVal (_bef .PdfObjectDictionary .Get ("\u0042\u0069t\u0073\u0050\u0065r\u0043\u006f\u006d\u0070\u006f\u006e\u0065\u006e\u0074"));_fbg {_eea .BitsPerComponent =_gga ;};if _ccc ,_gfd :=_b .GetIntVal (_bef .PdfObjectDictionary .Get ("\u0057\u0069\u0064t\u0068"));
_gfd {_eea .Width =_ccc ;};if _gbd ,_cdb :=_b .GetIntVal (_bef .PdfObjectDictionary .Get ("\u0048\u0065\u0069\u0067\u0068\u0074"));_cdb {_eea .Height =_gbd ;};if _ggcc ,_acdgb :=_b .GetStream (_bef .Get ("\u0053\u004d\u0061s\u006b"));_acdgb {_eea .SMask =&ImageSMask {Image :&_eea ,Stream :_ggcc };
_cda [_ggcc ]=struct{}{};};switch _eea .Colorspace {case "\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B":_eea .ColorComponents =3;case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079":_eea .ColorComponents =1;case "\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":_eea .ColorComponents =4;
default:_eea .ColorComponents =-1;};_gfca [_bef ]=_be ;_ca =append (_ca ,&_eea );_be ++;};var _befd []int ;for _ ,_ace :=range _ca {if _ace .SMask !=nil {_bfe ,_cfd :=_gfca [_ace .SMask .Stream ];if _cfd {_befd =append (_befd ,_bfe );};};};_aaa :=make ([]*Image ,len (_ca )-len (_befd ));
_be =0;_ddb :for _cgf ,_ddd :=range _ca {for _ ,_dcgd :=range _befd {if _cgf ==_dcgd {continue _ddb ;};};_aaa [_be ]=_ddd ;_be ++;};return _ca ,nil ;};type OutputIntent struct{Object *_b .PdfObjectDictionary ;};func (_dd *OutputIntents )Add (oi _b .PdfObject )error {_gfg ,_fad :=oi .(*_b .PdfObjectDictionary );
if !_fad {return _a .New ("\u0069\u006e\u0070\u0075\u0074\u0020\u006f\u0075\u0074\u0070\u0075\u0074\u0020\u0069\u006e\u0074\u0065\u006et\u0020\u0073\u0068\u006f\u0075\u006c\u0064 \u0062\u0065\u0020\u0061\u006e\u0020\u006f\u0062\u006a\u0065\u0063t\u0020\u0064\u0069\u0063\u0074\u0069\u006f\u006e\u0061\u0072\u0079");
};if _eee ,_bg :=_b .GetStream (_gfg .Get ("\u0044\u0065\u0073\u0074\u004f\u0075\u0074\u0070\u0075\u0074\u0050\u0072o\u0066\u0069\u006c\u0065"));_bg {_dd ._ag .Objects =append (_dd ._ag .Objects ,_eee );};_cb ,_cd :=oi .(*_b .PdfIndirectObject );if !_cd {_cb =_b .MakeIndirectObject (oi );
};if _dd ._cg ==nil {_dd ._cg =_b .MakeArray (_cb );}else {_dd ._cg .Append (_cb );};_dd ._ag .Objects =append (_dd ._ag .Objects ,_cb );return nil ;};type OutputIntents struct{_cg *_b .PdfObjectArray ;_ag *Document ;_abf *_b .PdfIndirectObject ;};type ImageSMask struct{Image *Image ;
Stream *_b .PdfObjectStream ;};func (_ccb *OutputIntents )Get (i int )(OutputIntent ,bool ){if _ccb ._cg ==nil {return OutputIntent {},false ;};if i >=_ccb ._cg .Len (){return OutputIntent {},false ;};_feg :=_ccb ._cg .Get (i );_ba ,_agb :=_b .GetIndirect (_feg );
if !_agb {_ff ,_cbf :=_b .GetDict (_feg );return OutputIntent {Object :_ff },_cbf ;};_cgg ,_cf :=_b .GetDict (_ba .PdfObject );return OutputIntent {Object :_cgg },_cf ;};func (_aag *Document )AddIndirectObject (indirect *_b .PdfIndirectObject ){for _ ,_dad :=range _aag .Objects {if _dad ==indirect {return ;
};};_aag .Objects =append (_aag .Objects ,indirect );};func (_ee *Catalog )SetVersion (){_ee .Object .Set ("\u0056e\u0072\u0073\u0069\u006f\u006e",_b .MakeName (_ac .Sprintf ("\u0025\u0064\u002e%\u0064",_ee ._c .Version .Major ,_ee ._c .Version .Minor )));
};type Image struct{Name string ;Width int ;Height int ;Colorspace _b .PdfObjectName ;ColorComponents int ;BitsPerComponent int ;SMask *ImageSMask ;Stream *_b .PdfObjectStream ;};type Page struct{_dce int ;Object *_b .PdfObjectDictionary ;_gb *Document ;
};type Content struct{Object _b .PdfObject ;};func (_dag *Page )Number ()int {return _dag ._dce };func (_db *Catalog )GetPages ()([]Page ,bool ){_cc ,_ec :=_b .GetDict (_db .Object .Get ("\u0050\u0061\u0067e\u0073"));if !_ec {return nil ,false ;};_f ,_cce :=_b .GetArray (_cc .Get ("\u004b\u0069\u0064\u0073"));
if !_cce {return nil ,false ;};_g :=make ([]Page ,_f .Len ());for _dc ,_fa :=range _f .Elements (){_bf ,_ea :=_b .GetDict (_fa );if !_ea {continue ;};_g [_dc ]=Page {Object :_bf ,_dce :_dc +1,_gb :_db ._c };};return _g ,true ;};func (_edg Content )GetData ()([]byte ,error ){_acg ,_agaf :=_b .GetStream (_edg .Object );
if !_agaf {return nil ,nil ;};_dcd ,_edcd :=_b .NewEncoderFromStream (_acg );if _edcd !=nil {return nil ,_edcd ;};_cgb ,_edcd :=_dcd .DecodeStream (_acg );if _edcd !=nil {return nil ,_edcd ;};return _cgb ,nil ;};func (_dgg *Catalog )NewOutputIntents ()*OutputIntents {return &OutputIntents {_ag :_dgg ._c }};
func (_df *Catalog )GetOutputIntents ()(*OutputIntents ,bool ){_edc :=_df .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");if _edc ==nil {return nil ,false ;};_fe ,_edb :=_b .GetIndirect (_edc );if !_edb {return nil ,false ;
};_ab ,_ad :=_b .GetArray (_fe .PdfObject );if !_ad {return nil ,false ;};return &OutputIntents {_abf :_fe ,_cg :_ab ,_ag :_df ._c },true ;};func (_dcb *Catalog )SetMetadata (meta _d .Metadata )error {_faa ,_gf :=meta .MarshalXMP ();if _gf !=nil {return _gf ;
};_dg ,_gf :=_b .MakeStream (_faa ,nil );if _gf !=nil {return _gf ;};_dg .Set ("\u0054\u0079\u0070\u0065",_b .MakeName ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));_dg .Set ("\u0053u\u0062\u0074\u0079\u0070\u0065",_b .MakeName ("\u0058\u004d\u004c"));
_dcb .Object .Set ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061",_dg );_dcb ._c .Objects =append (_dcb ._c .Objects ,_dg );return nil ;};func (_bgb Page )GetResources ()(*_b .PdfObjectDictionary ,bool ){return _b .GetDict (_bgb .Object .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));
};func (_aa *Catalog )HasMetadata ()bool {_af :=_aa .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061");return _af !=nil ;};func _gde (_dff _b .PdfObject )(_b .PdfObjectName ,error ){var _dfa *_b .PdfObjectName ;var _ebe *_b .PdfObjectArray ;
if _abg ,_gc :=_dff .(*_b .PdfIndirectObject );_gc {if _cfg ,_ffa :=_abg .PdfObject .(*_b .PdfObjectArray );_ffa {_ebe =_cfg ;}else if _acdg ,_fec :=_abg .PdfObject .(*_b .PdfObjectName );_fec {_dfa =_acdg ;};}else if _ebb ,_cee :=_dff .(*_b .PdfObjectArray );
_cee {_ebe =_ebb ;}else if _fd ,_aga :=_dff .(*_b .PdfObjectName );_aga {_dfa =_fd ;};if _dfa !=nil {switch *_dfa {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":return *_dfa ,nil ;
case "\u0050a\u0074\u0074\u0065\u0072\u006e":return *_dfa ,nil ;};};if _ebe !=nil &&_ebe .Len ()> 0{if _ga ,_gdc :=_ebe .Get (0).(*_b .PdfObjectName );_gdc {switch *_ga {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":if _ebe .Len ()==1{return *_ga ,nil ;
};case "\u0043a\u006c\u0047\u0072\u0061\u0079","\u0043\u0061\u006c\u0052\u0047\u0042","\u004c\u0061\u0062":return *_ga ,nil ;case "\u0049\u0043\u0043\u0042\u0061\u0073\u0065\u0064","\u0050a\u0074\u0074\u0065\u0072\u006e","\u0049n\u0064\u0065\u0078\u0065\u0064":return *_ga ,nil ;
case "\u0053\u0065\u0070\u0061\u0072\u0061\u0074\u0069\u006f\u006e","\u0044e\u0076\u0069\u0063\u0065\u004e":return *_ga ,nil ;};};};return "",nil ;};